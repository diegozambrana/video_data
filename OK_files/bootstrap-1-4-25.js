this.OK=this.OK||{},this.OK.msgBootstrap=function(e){"use strict";var d,t,f,m,p={pts:"/web-api/pts/msg",css:"MSG/messages_da23d629.css",model:"MSG/model_13191e19",notifier:"MSG/notifier_802f3dec",lottie:"MSG/lottie_f5295c41","mp3-encoder":"MSG/mp3-encoder_ac628dc9",ui:"MSG/ui_14ac2c5c",vendor:"MSG/vendor_7cd22c8b"},n=OK.logger,r=0;function o(e,t){return d||(o=t,i=S(n=e,"prefix"),s=(S(n,"version")||"1.0.127").replace(/-/g,"."),r=S(n,"socket-url"),a=S(n,"long-polling-url"),u=S(n,"load-count"),c=S(n,"uid"),l=function(e){if(function(e){return"1"===S(e,"shadow-root")&&e.attachShadow&&(!/Safari/.test(navigator.userAgent)||!/Apple/.test(navigator.vendor))&&!/\b_okSat=/.test(document.cookie)}(e)){var t=e.attachShadow({mode:"open"});return t.appendChild(document.createElement("slot")),t}return e}(n),v("start"),L(requirejs.toUrl(p.model+".js")),L(requirejs.toUrl(p.ui+".js")),L(requirejs.toUrl(p.vendor+".js")),L(requirejs.toUrl(p.notifier+".js")),L(p.pts),d=Promise.all([h("model").then(function(e){return e({socketUrl:r?new WebSocket(r+"?okweb=true&autoinit=true&version="+s):null,longPollingUrl:a,quickStart:"0"!==S(n,"quick-start"),wsProbeTimeout:9e3,fallbackTimeout:a?9e4:3e4,uiTimeout:a?12e4:6e4,minFirstChats:u?Number(u):void 0,loadAllUpdates:!!u&&200===Number(u),uid:c,version:s})}),h("ui"),new Promise(function(t,e){try{m=JSON.parse(localStorage.getItem("msgPTS"))}catch(e){}m&&(g("pts-local"),t(m)),m=null,h("pts").then(function(e){f&&f.store.updatePTS(e),t(m=e),localStorage.setItem("msgPTS",JSON.stringify(e))}).catch(e)}),function(i,s){return new Promise(function(e,t){function n(e){g(e),clearTimeout(o),t(new Error(e))}g("css-start");var r=k("stylesheet",s),o=setTimeout(n,3e4,"css-timeout");r.addEventListener("load",function(){clearTimeout(o),v("css"),e()}),r.addEventListener("error",function(){return n("css-error")}),(1!==i.nodeType?i:document.head).appendChild(r)})}(l,requirejs.toUrl(p.css))]).then(function(e){var t=e[0],n=e[1],r=e[2];return v("ready"),m&&r!==m&&Object.assign(r,m),f=n(l,t,{pts:r,uid:c,staticRoot:i,moduleMap:p,version:s}),o&&f.open(o),K(),f}));var n,o,i,s,r,a,u,c,l}function i(e){e.stopPropagation(),u()?a():(d||g("start-click"),s())}function s(t){OK.hidePopLayerIfAny&&OK.hidePopLayerIfAny(),_("msg_toolbar_button","toolbar_nav_a__messa__active"),O("msg_layer_wrapper","invisible"),f?f.open(t):d||o(b("msg_layer")).then(function(e){!OK.Layers||u()?(g("render-app"),e.open(t)):g("render-app-hidden")}).catch(function(){g("old-layer"),requirejs(["OK/utils/vanilla"],function(t){t.ajax({url:"/dk",data:{cmd:"MessagesToolbarButton","st.fallback":"true","st.shortLink":u()}}).then(function(e){return t.updateBlockModelCallback(e)})})}),c(l),w(!0)}function a(){O("msg_toolbar_button","toolbar_nav_a__messa__active"),_("msg_layer_wrapper","invisible"),c(y),f&&f.close(),w()}function h(r){return g(r+"-load-start"),new Promise(function(t,n){requirejs([p[r]],function(e){v(r),t(e)},function(e){g(r+"-load-fail"),n(e)})})}function S(e,t){return e.getAttribute("data-"+t)}function u(){return OK.Layers&&OK.Layers.isLayerOpened("messages")}function v(e){var t=performance.now();g(e),"start"===e?r=t:r&&n.duration("messagesLayer",t-r,"loading.ttdur."+e)}function g(e){n.success("messagesLayer","tt-loader",e)}function c(e){OK.Layers?e():OK.loader.use("OKCustomJs",e)}function l(){OK.Layers.unregisterAll(),OK.Layers.onLayerShown(),OK.Layers.register("messages",a)}function y(){OK.Layers.remove("messages"),OK.Layers.onLayerHidden()}function b(e){return document.getElementById(e)}function _(e,t){var n=b(e);n&&n.classList.add(t)}function O(e,t){var n=b(e);n&&n.classList.remove(t)}function k(e,t){var n=document.createElement("link");return n.rel=e,n.href=t,n}function L(e){var t=k("preload",e);t.as="script",document.head.appendChild(t)}function K(t){P().then(function(e){t?e.start(t,function(e){return s(e.url)}):e.pushStop()})}function w(t){requirejs(["OK/ToolbarGrowl"],function(e){t?e.destroyByLayerId("messages"):e.showAny()})}function P(){return t=t||h("notifier")}return e.activate=function(e){e.addEventListener("click",i),d||K(e)},e.activatePush=function(){P().then(function(e){return e.activate()})},e.attachesSelected=function(e){f&&f.attachesSelected(e)},e.buySmileyServiceCb=function(){f&&f.buySmileyServiceCb()},e.close=a,e.deactivate=function(e){e.removeEventListener("click",i)},e.deactivatePush=function(){P().then(function(e){return e.pushStop()})},e.hideSendActionMenu=function(){f&&f.hideSendActionMenu()},e.init=function(){},e.insertSmile=function(e){f&&f.insertSmile(e)},e.isOpen=u,e.load=o,e.open=s,e.pushSubscribe=function(t){P().then(function(e){return e.pushSubscribe(t)})},e.resendSticker=function(){f&&f.resendSticker()},e.sendSticker=function(e){f&&f.sendSticker(e)},e.setPushContent=function(t){P().then(function(e){return e.setNewContent(t)})},e.updateStickerSets=function(){f&&f.updateStickerSets()},e}({}),define("MSG/bootstrap",OK.msgBootstrap);
//# sourceMappingURL=bootstrap-1-4-25.js.map
